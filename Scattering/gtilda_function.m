function gt = gtilda_function(T)

    if T >= 120E-3 % GeV

        % Coefficients from Table 1
        a = [1, 1.11724, 0.312672, -0.0468049, -0.0265004, -0.0011976, ...
             0.000182812, 0.000136436, 8.55051e-05, 1.2284e-05, 3.82259e-07, -6.87035e-09];
        b = [0.0143382, 0.0137559, 0.00292108, -0.000538533, -0.000162496, -2.87906e-05, ...
             -3.84278e-06, 2.78776e-06, 7.40342e-07, 1.1721e-07, 3.72499e-09, -6.74107e-11];
        c = [1, 0.607869, -0.154485, -0.224034, -0.0282147, 0.029062, ...
             0.00686778, -0.00100005, -0.000169104, 1.06301e-05, 1.69528e-06, -9.33311e-08];
        d = [70.7388, 91.8011, 33.1892, -1.39779, -1.52558, -0.0197857, ...
             -0.160146, 8.22615e-05, 0.0202651, -1.82134e-05, 7.83943e-05, 7.13518e-05];
        
        % Compute log temperature
        t = log(T);
        
        num_g_rho = sum(a .* t.^(0:11));
        den_g_rho = sum(b .* t.^(0:11));
        num_g_ratio = sum(c .* t.^(0:11));
        den_g_ratio = sum(d .* t.^(0:11));

        dnum_g_rho = sum(a(2:end) .* (1:11) .* t.^(0:10))/T;
        dden_g_rho = sum(b(2:end) .* (1:11) .* t.^(0:10))/T;
        dnum_g_ratio = sum(c(2:end) .* (1:11) .* t.^(0:10))/T;
        dden_g_ratio = sum(d(2:end) .* (1:11) .* t.^(0:10))/T;
    
        %g_s = (num_g_rho ./ den_g_rho) ./ (1 + num_g_ratio ./ den_g_ratio);

        gt = (T/3)*(dnum_g_rho ./ num_g_rho - dden_g_rho ./ den_g_rho - (dnum_g_ratio ./ num_g_ratio - dden_g_ratio ./ den_g_ratio) ./ (den_g_ratio ./ num_g_ratio + 1) ); 

    else
    
        % Parameter values in GeV
        me = 511e-6;
        mmu = 0.1056;
        mpi0 = 0.135;
        mpipm = 0.140;
        m1 = 0.5;
        m2 = 0.77;
        m3 = 1.2;
        m4 = 2.0;

        S_fit = @(x) 1 + (7/4) * exp(-1.0419*x) .* (1 + 1.034*x + 0.456426*x.^2 + 0.0595249*x.^3);
        f_s = @(x) exp(-1.04190*x) .* (1 + 1.03400*x + 0.456426*x.^2 + 0.0595248*x.^3);
        b_s = @(x) exp(-1.03365*x) .* (1 + 1.03397*x + 0.342548*x.^2 + 0.0506182*x.^3);

        dS_fit = @(x) (7/4)*exp(-1.0419*x).*( -1.0419*(1 + 1.034*x + 0.456426*x.^2 + 0.0595249*x.^3) + (1.034 + 2*0.456426*x + 3*0.0595249*x.^2) );
        df_s = @(x) exp(-1.04190*x).*( -1.04190*(1 + 1.03400*x + 0.456426*x.^2 + 0.0595248*x.^3) + (1.03400 + 2*0.456426*x + 3*0.0595248*x.^2) );
        db_s = @(x) exp(-1.03365*x).*( -1.03365*(1 + 1.03397*x + 0.342548*x.^2 + 0.0506182*x.^3) + (1.03397 + 2*0.342548*x + 3*0.0506182*x.^2) );
        
        % Compute g_s(T) using Eq. (C.4)
        g_s = 2.008 + 1.923 * S_fit(me./T) + 3.442 * f_s(me./T) + 3.468 * f_s(mmu./T) + ...
                 1.034 * b_s(mpi0./T) + 2.068 * b_s(mpipm./T) + 4.16 * b_s(m1./T) + ...
                 30.55 * b_s(m2./T) + 90 * b_s(m3./T) + 6209 * b_s(m4./T);

        dg_s = -(me./T.^2).*( 1.923*dS_fit(me./T) + 3.442*df_s(me./T) ) -(mmu./T.^2).* 3.468 * df_s(mmu./T) + ...
            -1.034*(mpi0./T.^2).*db_s(mpi0./T) - 2.068*(mpipm./T.^2).*db_s(mpipm./T) - 4.16*(m1./T.^2).*db_s(m1./T) + ...
            -30.55*(m2./T.^2).*db_s(m2./T) - 90*(m3./T.^2).*db_s(m3./T) - 6209*(m4./T.^2).*db_s(m4./T);

        gt = (T/3/g_s)*dg_s;

    end
end